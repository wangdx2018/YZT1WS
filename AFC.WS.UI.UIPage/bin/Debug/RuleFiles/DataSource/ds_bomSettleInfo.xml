<?xml version="1.0"?>
<DataSourceRule xmlnsxsi="http//www.w3.org/2001/XMLSchema-instance" xmlnsxsd="http//www.w3.org/2001/XMLSchema" DataSourceName="ds_bomSettleInfo" DataSourceTypeName="AFC.WS.UI.DataSources.DefaultDataSource,AFC.WS.UI.FC" ComboBoxDataSource="DefaultDataSource">
  <PropertyValues>
    <PropertyValue Key="DBConnectionString" />
    <PropertyValue Value="
select *
  from (select t.busi_udsn,
               t.line_id,
               t.station_id,
               t.station_cn_name,
               t.device_id,
               t.operator_id,
               t.operator_name,
               t.occur_date_time,
               t.settlement_date,
               (sum(SailDanChengTikcetsAmount)) SailDanChengTikcetsAmount,
               (sum(SailDanChengTikcetsNum)) SailDanChengTikcetsNum,
               (sum(YiPiaoTongChongZhiAmount)) YiPiaoTongChongZhiAmount,
               (sum(YiPiaoTongChongZhiNum)) YiPiaoTongChongZhiNum,
               (sum(TranBuPiaoAmount)) TranBuPiaoAmount,
               (sum(TranBuPiaoNum)) TranBuPiaoNum,
               (sum(GuZhangTuiKuanAmount)) GuZhangTuiKuanAmount,
               (sum(GuZhangTuiKuanNum)) GuZhangTuiKuanNum,
               (sum(TranTuiPiaoAmount)) TranTuiPiaoAmount,
               (sum(TranTuiPiaoNum)) TranTuiPiaoNum,
               (sum(TranDiXiaoAmount)) TranDiXiaoAmount,
               (sum(TranDiXiaoNum)) TranDiXiaoNum,
               (sum(SailYKTAmount)) SailYKTAmount,
               (sum(SailYKTNum)) SailYKTNum,
               (sum(ChongZhiYKTAmount)) ChongZhiYKTAmount,
               (sum(ChongZhiYKTNum)) ChongZhiYKTNum,
               (sum(XianJinBuPiaoAmount)) XianJinBuPiaoAmount,
               (sum(XianJinBuPiaoNum)) XianJinBuPiaoNum,
               (sum(ShouKaYajinAmount)) ShouKaYajinAmount,
               (sum(ShouKaYajinNum)) ShouKaYajinNum,
               (sum(FeiYingYeShouRuAmount)) FeiYingYeShouRuAmount,
               (sum(FeiYingYeShouRuNum)) FeiYingYeShouRuNum,
               (sum(FeiYingYeZhiChuAmount)) FeiYingYeZhiChuAmount,
               (sum(FeiYingYeZhiChuNum)) FeiYingYeZhiChuNum
          from (select ddsi.busi_udsn,
                       ddsi.line_id,
                       ddsi.station_id,
                       bsi.station_cn_name,
                       ddsi.device_id,
                       ddsi.operator_id,
                       poi.operator_name,
                       ddsi.settlement_date,
                       (to_date(ddsi.occur_date_time, 'YYYYMMDDHH24MISS')) occur_date_time,
                       (
                       decode(ddsi.tran_type,
                               '01',
                               (ddsi.tran_amount+ddsi.deposit_amount),
                               '0')) SailDanChengTikcetsAmount,
                       (decode(ddsi.tran_type,
                               '01',
                               ddsi.tran_acount,
                               '0')) SailDanChengTikcetsNum,
                       (decode(ddsi.tran_type,
                               '02',
                               sum(ddsi.tran_amount),
                               '0')) YiPiaoTongChongZhiAmount,
                       (decode(ddsi.tran_type,
                               '02',
                               sum(ddsi.tran_acount),
                               '0')) YiPiaoTongChongZhiNum,
                       (decode(ddsi.tran_type,
                               '05',
                               sum(ddsi.tran_amount),
                               '0')) TranBuPiaoAmount,
                       (decode(ddsi.tran_type,
                               '05',
                               sum(ddsi.tran_acount),
                               '0')) TranBuPiaoNum,
                       (decode(ddsi.tran_type,
                               'EF',
                               sum(-ddsi.tran_amount),
                               '0')) GuZhangTuiKuanAmount,
                       (decode(ddsi.tran_type,
                               'EF',
                               sum(ddsi.tran_acount),
                               '0')) GuZhangTuiKuanNum,
                       (decode(ddsi.tran_type,
                               '06',
                               sum(-ddsi.tran_amount),
                               '0')) TranTuiPiaoAmount,
                       (decode(ddsi.tran_type,
                               '06',
                               sum(ddsi.tran_acount),
                               '0')) TranTuiPiaoNum,
                       (decode(ddsi.tran_type,
                               '07',
                               sum(-ddsi.tran_amount),
                               '0')) TranDiXiaoAmount,
                       (decode(ddsi.tran_type,
                               '07',
                               sum(ddsi.tran_acount),
                               '0')) TranDiXiaoNum,            
                       (decode(ddsi.tran_type,
                               '81',
                               sum(ddsi.tran_amount + ddsi.fee_amount +
                                   ddsi.cost_amount),
                               '0')) SailYKTAmount,
                       (decode(ddsi.tran_type,
                               '81',
                               sum(ddsi.tran_acount),
                               '0')) SailYKTNum,
                       (decode(ddsi.tran_type,
                               '82',
                               sum(ddsi.tran_amount),
                               '0')) ChongZhiYKTAmount,
                       (decode(ddsi.tran_type,
                               '82',
                               sum(ddsi.tran_acount),
                               '0')) ChongZhiYKTNum,
                       (decode(ddsi.tran_type,
                               '85',
                               sum(ddsi.tran_amount),
                               '0')) XianJinBuPiaoAmount,
                       (decode(ddsi.tran_type,
                               '85',
                               sum(ddsi.tran_acount),
                               '0')) XianJinBuPiaoNum,
                       (decode(ddsi.tran_type,
                               '81',
                               sum(ddsi.deposit_amount),
                               '0')) ShouKaYajinAmount,
                       (decode(ddsi.tran_type,
                               '81',
                               sum(ddsi.tran_acount),
                               '0')) ShouKaYajinNum,            
                       (decode(ddsi.tran_type,
                               'ED',
                               sum(ddsi.tran_amount),
                               '0')) FeiYingYeShouRuAmount,
                       (decode(ddsi.tran_type,
                               'ED',
                               sum(ddsi.tran_acount),
                               '0')) FeiYingYeShouRuNum,
                       (decode(ddsi.tran_type,
                               'EE',
                               sum(-ddsi.tran_amount),
                               '0')) FeiYingYeZhiChuAmount,
                       (decode(ddsi.tran_type,
                               'EE',
                               sum(ddsi.tran_acount),
                               '0')) FeiYingYeZhiChuNum
                  from data_dev_settlement_info ddsi
                  left join basi_station_info bsi on bsi.station_id =
                                                     ddsi.station_id
                  left join priv_operator_info poi on poi.operator_id =
                                                      ddsi.operator_id
                 group by ddsi.busi_udsn,
                          ddsi.line_id,
                          ddsi.station_id,
                          bsi.station_cn_name,
                          ddsi.device_id,
                          ddsi.operator_id,
                          poi.operator_name,
                          ddsi.settlement_date,
                          occur_date_time,
                          tran_type,
                          ddsi.tran_sub_type,
                          ddsi.ticket_type,
                          ddsi.deposit_amount,
                          ddsi.tran_amount,
                          ddsi.fee_amount,
                          ddsi.cost_amount,
                          ddsi.tran_acount) t
         group by t.busi_udsn,
                  t.line_id,
                  t.station_id,
                  t.station_cn_name,
                  t.device_id,
                  t.operator_id,
                  t.operator_name,
                  t.occur_date_time,
                  t.settlement_date)" Key="Sql" />
    <PropertyValue Key="GroupParams" />
    <PropertyValue Key="HavingParams" />
    <PropertyValue Key="WhereParams" />
    <PropertyValue Value="occur_date_time desc" Key="OrderByParams" />
  </PropertyValues>
</DataSourceRule>